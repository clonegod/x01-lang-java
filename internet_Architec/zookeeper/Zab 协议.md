## Zab - ZooKeeper Atomic Broadcast 原子消息广播

Paxos 算法能完美地达到分布式系统的一致性，但由于较为复杂，在实际工程上不是很合适。

Zab 协议借鉴了 Paxos 的思想，并进行了改进，以满足工程上的实际需求。

参考：[ZAB协议介绍](https://www.jianshu.com/p/fb527a64deee)

## 	设计目标
### 一致性
集群中各个节点的数据保持一致。

### 有序性：
有序性是 Zab 协议与 Paxos 协议的一个核心区别。Zab 的有序性主要表现在两个方面：
	全局有序：
	如果消息 a 在消息 b 之前被投递，那么在任何一台服务器，消息 a都会在消息 b 之前被投递。
	
	因果有序：
	如果消息 a 在消息 b 之前发生（a 导致了 b），并被一起发送，则 a 始终在 b 之前被执行。

### 容错性
有 2f+1 台服务器，只要有大于等于 f+1 台（超过半数）的服务器正常工作，就能完全正常工作。


## 协议内容
Zab 协议分为两大块：

广播（boardcast）：

	Zab 协议中，所有的写请求都由 leader 来处理。
	正常工作状态下，leader 接收请求并通过广播协议来处理。

恢复（recovery）：

	当服务初次启动，或者 leader 节点挂了，系统就会进入恢复模式，
	直到选出了有合法数量 follower 的新 leader，
	然后新 leader 负责将整个系统同步到最新状态。

